# Project Data and Code Overview

## 1. Introduction
- **Purpose of this Project:** This project focuses on designing and implementing a custom observer for a CrazyFlie drone equipped with a Loco positioning deck to track a moving radio beacon in real time. By attaching a single Loco positioning Anchor to a person of interest—such as a university chancellor—the drone can follow the individual without relying on a motion capture system, enabling continuous and flexible tracking in large, crowded environments like stadiums. Leveraging the drone’s equations of motion and applying a linear quadratic regulator (LQR) for optimal control, along with an onboard gradient descent algorithm, the drone maintains a safe and consistent distance from the target. Analysis through Root Mean Squared Error (RMSE) confirms that the observer accurately estimates the Anchor’s position, ensuring reliable and precise tracking performance.
- **Contents of this Repository:** Below is a summary of the project folder structure.

## 2. 1_Data
- **Flight Test Logs (JSON files):**
  - Files can be found in DATA Folder.
  - `calibration_default_obs_varying_height.json` contains the json file with flight data used for the state space derivation.
  - `calibration_default_obs_2.json` contains the json file with flight data used to test the offline implementation of observer.
  - `Follower_test_stationary.json` contains the json file with flight data for stationary anchor online implementation.
  - `Follower_test_moving2.json` contains the json file with flight data for moving anchor online implementation.

## 3. 2_Code
- **Firmware (C):**
  - FIRMWARE contains the C code for the custom controller and observer. It can be included in the drone's firmware by copying it into the /src/modules/src/controller folder in the CrazyFlie source code.
  
- **Client (Python):**
  - CLIENT contains the interface between the C libaries and python scripts such as Flight.py that allow you to interact with the drone. 

- **Additional_python_tools (Python):**
  - ADDITIONAL_PYTHON_TOOLS contains other pertinent python code such as AE483 tools that is referenced in subsequent notebooks as a library containing analytical tools.

- **Analysis (Notebooks):**
  - `offline-implementation.ipynb` contains the callibration notebook pertaining to milestone which aims to collect data using 4 anchors to create an environment and 1 anchor to use as the target reference. 
  - `state-space-derivation` aims to derive the equations of motion and integrate the model for loco system into the controller and observer. 
  - `post-analysis` contains the analysis notebook used to process online implementation of the observer for both a stationary anchor and a moving anchor. The post analysis notebook also contains the videos created during the project. 

## 4. Organization and Requirements
- **Directory Structure:**
  - List all folders and files included.
  - 1_DATA
  - 2_CODE
  - - FIRMWARE
  - - CLIENT
  - - ADDITIONAL_PYTHON_TOOLS
  - - ANALYSIS

## 5. Environment and Dependencies
- **Conda Environment:**
  - `ae483` conda environment (as used throughout the semester) was used in this project.

## 6. Reproducibility
- **Running the Notebooks:**
  1. Run `state-space-derivation` to generate the state space model (A, B, C, D matrices) of the drone.
  2. Run `offline-implementation` to create the offline observer model based on the `model.json` file generated by `state-space-derivation`.
  3. Run `post-analysis` to analyze the data generated from flights and see the results that we found.
  4. If you want to modify the firmware of the drone, you must change the coefficients of the observer model in `offline-implementation`, see that it is effective offline, and convert the observer from Python to C code. Paste this converted where it is already implemented in the C controller code.




